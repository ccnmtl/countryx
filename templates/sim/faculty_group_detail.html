{% extends "sim/base_sim.html" %}

{% block css %}
{{ block.super }}
<style type='text/css'>
  @import "/sim/media/css/faculty.css";
</style>
{% endblock %}

{% block content %}
   {{ block.super }}
   <br />
    <table class="datagrid" style="width: 800px">
      <thead>
         <tr>
            <th style="width: 200px"><a href="/sim/faculty/groups/{{section.id}}/">{{section}}</a></th>
            <th style="width: 200px">Group &mdash; {{ group.name }}</th>
            <th />
         </tr>
      </thead>   
   </table>
   <br />
   
   {% for t in turns %}
      <a name="turn{{t.group_state.state.turn}}"/>
      <h2>Turn {{t.group_state.state.turn}} {{t.group_state.state.name}}</h2>
      Group Status:        
	      {% ifequal t.group_state.status 1 %}
	         No Action Taken
	      {% endifequal %}
	      {% ifequal t.group_state.status 2 %}
	         In Progress
	      {% endifequal %}
	      {% ifequal t.group_state.status 4 %}
	         Completed Turn
	      {% endifequal %}
      <br />
      Updated: {{ t.group_state.date_updated }}<br />
      Conditions: 
      <div class="scrollable_text">{% autoescape off %}{{ t.country_condition }}{% endautoescape %}</div>
      <br />
      
      <table id="sortable_table" class="datagrid">
      <thead>
         <tr>
            <th mochi:format="str">First Name</th>
            <th mochi:format="str">Last Name</th>
            <th mochi:format="str">Uni</th>
            <th mochi:format="str">Role</th>
            <th mochi:format="str">Status</th>
            <th mochi:format="date">Date Submitted</th>
            <th mochi:format="str">Feedback</th>
            <th>Action</th>
         </tr>
      </thead>
      <tfoot class="invisible">
          <tr>
              <td colspan="0"></td>
          </tr>
      </tfoot>
      <tbody>
          {% for p in t.players %}
            <tr>
               <td>{{ p.model.user.first_name }}</td>
               <td>{{ p.model.user.last_name }}</td>
               <td>{{ p.model.user.username }}</td>
               <td>{{ p.model.role.name }}</td>
               <td>
                  {% ifequal p.submit_status 1 %}
                     No Action Taken
	               {% endifequal %}
	               {% ifequal p.submit_status 2 %}
	                  Decision Pending
	               {% endifequal %}
	               {% ifequal p.submit_status 4 %}
	                  Submitted
	               {% endifequal %}
               </td>
		         {% if p.turn %}
		            <td>{{ p.turn.submit_date }}</td>
		            <td>
		               {% if p.turn.feedback %}
		                  Completed<br />{{ p.turn.feedback_date }}<br />by {{ p.turn.faculty.user }}
		               {% else %}
		                  Pending
		               {% endif %}
		            </td>
		         {% else %}
		             <td/><td/>            
		         {% endif %}
		         <td><a href="/sim/faculty/player/{{ group.id }}/{{ p.model.id }}/{{t.group_state.state.id}}/">Detail</a></td>
		      </tr>
		    {% endfor %}
		 </tbody>
       </table>
   {% endfor %}
    
{% endblock %}