{% extends "sim/base_player.html" %}

{% load range_node %}
{% load iflessthan %}

{% block js %} 
   {{ block.super }}
   <script type="text/javascript" src="/sim/media/js/game.js"></script>
{% endblock %}

{% block content %}
{{ block.super }}

<div class="main">
   <table>
      <tr>
         <!--  Column 1 -- Player -->
         <td  class="column1">
            <!--  You -->    
            <table>
               <tr>
                  <td colspan="2"><div class="section_header">REPRESENTATIVE PROFILES</div></td>
               </tr>

               <tr><td colspan="2"><div class="player_rolename">{{ you.model.role.name }} (You)</div></td></tr>
               <tr>
                  <td colspan="2">
                     <div id="{{you.model.role.name}}_description" class="your_description scrollable">{{ you.model.role.description }}</div>
                  </td>
               </tr>
                     
               <!--  Everyone Else -->
               {% for player in players %}
                  <tr><td colspan="2"><div class="player_rolename">{{ player.model.role.name }}</div></td></tr>
                  <tr>
                     <td width="100%">
                        <div id="{{player.model.role.name}}_image" class="player_image"><img src="/sim/media/images/silhouette.jpg"></div>
                        <div id="{{player.model.role.name}}_description" class="player_description invisible">{{ player.model.role.description }}</div>
                     </td>
                     <td>
                        <div class="character_choice" onclick="toggleCharacterProfile(this, '{{player.model.role.name}}')">Character<br />Profile</div>
                        <div class="character_choice" onclick="requestOfflineNegotiations(this)">Request<br />Offline<br />Negotiation</div>
                        <div id="{{player.model.role.name}}_choice" class="character_choice">
	                        {% ifequal player.submit_status 1 %}
	                           No ActionTaken
	                        {% endifequal %}
	                        {% ifequal player.submit_status 2 %}
                                Decision Pending
                             {% endifequal %}
                             {% ifequal player.submit_status 4 %}
                                Submitted
                             {% endifequal %}
                        </div>
                     </td>
                  </tr>
               {% endfor %}
            </table> 
            
            </td>
            <td class="column2">
               <!--  Column 2 -->
               
               <!--  Turn Tabs -->
               <div id="tabs" class="tabs">
	               {% for t in tabs %}
	                 <span id="turn{{t.id}}" class="{% if t.activetab and t.viewable %} activetab {% endif %} {% if not t.activetab and t.viewable %} viewableturn {% endif %} {% if not t.activetab and not t.viewable %} futureturn {% endif %}">
	                    {%if t.viewable %}
	                       <a href="/sim/player/game/{{group.id}}/{{t.id}}/">Turn {{t.id}}</a>
	                    {% else %}
	                       Turn {{t.id}}
	                    {% endif %}
	                 </span>
	               {% endfor %}
	            </div>
               
               <div class="section_header">CURRENT COUNTRY CONDITIONS &mdash; {{ state }}</div>
               <br />
               
               <div class="country_conditions_graph">
                  {% for condition in conditions %}
                     <table cellpadding="0" cellspacing="0">
                        <tr><td rowspan="5" class="condition_row_name">{{condition.name}}&nbsp;</td></tr>
                        <tr>
                            {% num_range 10 as row_count %}
								    
								    {% for i in row_count %}
								      {% ifequal i condition.value %}
								         <td class="condition_row_indicator" rowspan="2">{{condition.value}}</td>
								      {% else %}
								         <td class="condition_row_dummy">&nbsp;</td>
								      {% endifequal %}
								    {% endfor %}
                        </tr>
                        <tr>
                           {% num_range 9 as row_count %}
                            
                           {% for i in row_count %}
                              {% iflessthan i condition.value %}
                                 <td class="condition_row_block_filled">&nbsp;</td>
                              {% else %}
                                 <td class="condition_row_block_empty">&nbsp;</td>
                              {% endiflessthan %}
                           {% endfor %}
                       </tr>
                       <tr>
                           <td colspan="5" class="condition_row_description" style="text-align: left">{{condition.least}}</td>
                           <td colspan="5" class="condition_row_description" style="text-align: right">{{condition.most}}</td>
                       </tr>
                       <tr><td class="condition_row_description" colspan="11">&nbsp;</td></tr>
                       
                     </table>
                  {% endfor %}
               </div>
               <br />
               
               <!--  Country Conditions / Text & Graph -->
               <div class="country_conditions">
                  <div class="country_conditions_textarea scrollable">
                     <b>Economic and Political Snapshot</b><br/><br />
                     {% autoescape off %}{{ country_condition }}{% endautoescape %}
                  </div>
               </div>

            </td>
            <td class="column3">
               <!-- Column 3 -->
               
               <div class="section_header">YOUR OPTIONS</div>
               
               <div id="errorMsg" class="error invisible"></div>
               <div id="successMsg" class="success invisible"></div>
               
               <!--  Choices / Clock -->
               <div>
                  <div id="current_choice" class="invisible">{{ you.saved_turn.choice }}</div>
                  {% ifequal 1 you.submit_status %}
                     <div id="submit_state_desc" class="player_rolename">Status: No Action Taken</div< 
                     <!--  not yet selected -->
                     {% for c in you.choices %}
                        <div id="{{c.choice}}" class="player_choice" onclick="choose(this, {{ c.choice }}); return true;">{{ c.desc }}</div><br />
                     {% endfor %}
                     <div id="reasoning_form" style="display: none">
	                     <div id="errorClient" class="error invisible"></div>
	                     <textarea id="reasoning" class="reasoning">Enter your reasoning here</textarea>
	                     <input id="savedraft" type="submit" value="save draft" onclick="saveChoice(this, 0); return true;"/>
	                     <input id="submit" type="submit" value="submit" onclick="saveChoice(this, 1); return true;"/>
	                     <input id="clear" type="submit" value="clear" onclick="clearChoice(this); return true;"/>
	                  </div>
                  {% endifequal %}
               
                  {% ifequal 2 you.submit_status %}
                     <div id="submit_state_desc" class="player_rolename">Status: Decision Pending</div<
                     <!--  in draft -->
                     {% for c in you.choices %}
                        {% ifequal c.choice you.saved_choice.choice %}
                           <div id="{{c.choice}}" class="player_choice" onclick="choose(this, {{ c.choice }}); return true;">{{ c.desc }}</div><br />
                        {% else %}
                           <div id="{{c.choice}}" class="player_choice invisible" onclick="choose(this, {{ c.choice }}); return true;">{{ c.desc }}</div><br />
                        {% endifequal %}
                     {% endfor %}
                     <div id="reasoning_form" style="display: block">
                        <div id="errorClient" class="error invisible"></div>
                        <textarea id="reasoning" class="reasoning">{{ you.saved_turn.reasoning }}</textarea>
                        <input id="savedraft" type="submit" value="save draft" onclick="saveChoice(this, 0); return true;"/>
                        <input id="submit" type="submit" value="submit" onclick="saveChoice(this, 1); return true;"/>
                        <input id="clear" type="submit" value="clear" onclick="clearChoice(this); return true;"/>
                     </div>
                  {% endifequal %}
                  
                  {% ifequal 4 you.submit_status %}
                     <div id="submit_state_desc" class="player_rolename">Final Submit</div>
                     <!--  submitted -->    
                     <div id="{{you.saved_choice.choice}}" class="player_choice">{{ you.saved_choice.desc }}</div><br />
	                  <div id="reasoning_form" style="display: block">
	                     <div id="errorClient" class="error invisible"></div>
	                     <textarea id="reasoning" class="reasoning" readonly="true">{{ you.saved_turn.reasoning }}</textarea>
	                  </div>
                  {% endifequal %}
               </div>
            </td>
         </tr>
    </table>
</div>    
{% endblock %}